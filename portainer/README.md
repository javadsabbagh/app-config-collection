
### Running Portainer Server
```bash
docker run -d -p 8000:8000 -p 9443:9443 \
                --name portainer-ce \
                --restart=always \
                -v /var/run/docker.sock:/var/run/docker.sock \
                -v portainer_data:/data \
                portainer/portainer-ce:2.18.4-alpine
```

> Note: older versions were using insecure port of 9000. Now, it's recommended to use secure 9443 port for communication between 
> agent and server.
> Port 9000 is still accessible, but not recommended, for backward compatibility.

### Running Portainer Agent
For agents, we need to access over internet, as well as local network, we need to deploy agent as edge: 
```bash
docker run -d \
  -p 9001:9001 \
  --name portainer_agent \
  --restart=always \
  -v /var/run/docker.sock:/var/run/docker.sock \
  -v /var/lib/docker/volumes:/var/lib/docker/volumes \
  portainer/agent:2.18.4-alpine
```

This scenario is like:  Portainer Agent <-- Portainer Server (pull scenario).

### Running Portainer Edge Agent
For agents, we need to access over internet, as well as local network, we need to deploy agent as edge: 
```bash
docker run -d   -v /var/run/docker.sock:/var/run/docker.sock  \
                -v /var/lib/docker/volumes:/var/lib/docker/volumes \
                -v /:/host  \
                -v portainer_agent_data:/data  \
                --restart always   \
                -e EDGE=1  \
                -e EDGE_ID=0805a956-46f5-4b74-aed4-f44f85f8fcaf  \
                -e EDGE_KEY=aHR0cHM6Ly8xOTIuMTY4LjEwMC4xMTc6OTQ0M3wxOTIuMTY4LjEwMC4xMTc6ODAwMHxkOTo5MzoxNjpkNDo3MTo5MDo0NTo1YTo0Nzo0Mjo0Mzo2ZTphMzphZjpiYTpiOXwxMw  \
                -e AGENT_CLUSTER_ADDR=192.168.100.117:9443  \
                -e EDGE_INSECURE_POLL=1 \
                --name portainer_edge_agent \
                portainer/agent:2.18.4-alpine
```

> Edge key is generated by portainer server.

This scenario is like:  Portainer Agent Edge --> Portainer Server (push scenario).